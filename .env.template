# h-cli Configuration
# Copy to .env and fill in your values: cp .env.template .env

# ── Deployment ──────────────────────────────────────────────────────────

# Environment tag — empty for production, "dev" for dev instance
# Dash separator is added automatically (e.g. dev → h-cli-dev-core)
ENV_TAG=

# Core container base image (default: debian:12-slim, alternative: parrotsec/core:7.1)
CORE_BASE_IMAGE=debian:12-slim

# SSH Keys Directory (override to use keys from a different path)
SSH_KEYS_DIR=./ssh-keys

# ── Telegram ────────────────────────────────────────────────────────────

TELEGRAM_BOT_TOKEN=your-bot-token-here

# Friendly names for session chunk directories (chat_id:name pairs, comma-separated)
# Falls back to numeric chat ID if not mapped
CHAT_NAMES=

# ── Redis & Sessions ───────────────────────────────────────────────────

REDIS_PASSWORD=changeme-generate-a-real-password

# Session TTL (seconds) — conversation context window (default: 4 hours)
SESSION_TTL=14400

# History TTL (seconds) — how long conversation history stays in Redis (default: 24 hours)
# Separate from SESSION_TTL — history survives longer so it can be dumped to disk
HISTORY_TTL=86400

# ── Models ──────────────────────────────────────────────────────────────

# Claude Code authentication (one-time setup)
# Run: claude login (inside the container or locally), then copy the token here.
CLAUDE_CODE_OAUTH_TOKEN=
# Model selection — override to use different models or local inference
# MAIN_MODEL: default model for tasks (user can override via Telegram keyboard)
# GATE_MODEL: model used by the Asimov firewall gatekeeper
MAIN_MODEL=opus
FAST_MODEL=haiku
GATE_MODEL=haiku

# Offline / local inference — point to your own Ollama or compatible API
# Main model and gatekeeper can use separate servers.
# To go offline, set the vars below and change MAIN_MODEL/GATE_MODEL above.
#ANTHROPIC_BASE_URL=http://h-oracle:11434        # main model server
#ANTHROPIC_AUTH_TOKEN=ollama
#ANTHROPIC_API_KEY=
#GATE_BASE_URL=http://h-titan:11434              # gate model server (can differ)
#GATE_AUTH_TOKEN=ollama
#GATE_API_KEY=

# ── Security ────────────────────────────────────────────────────────────

MAX_CONCURRENT_TASKS=3
TASK_TIMEOUT=300
ALLOWED_CHATS=

# Result HMAC — signs task results so telegram-bot can verify authenticity
# Auto-generated by install.sh. Do not share.
RESULT_HMAC_KEY=

# Asimov Firewall — independent model checks every command against ground rules
# Adds ~2-3s latency per command. Set to true for production environments.
GATE_CHECK=true

# Sudo whitelist — comma-separated commands hcli can run as root (full paths resolved at startup)
SUDO_COMMANDS=nmap,tcpdump,traceroute,mtr,ping,ss,ip,iptables

# Command pattern blacklist — pipe-separated patterns blocked before gate check (deterministic, zero latency)
# Catches obfuscation tricks that an LLM gate might miss. Applied regardless of GATE_CHECK setting.
BLOCKED_PATTERNS=| bash|| sh|| zsh|base64 -d|base64 --decode

# External pattern file — one pattern per line, lines starting with # are ignored
# Default ships with ~80 patterns across 12 categories (blocked-patterns.txt)
# Override to use your own CVE signatures, large denylist feeds, or externally managed patterns
# Merged with BLOCKED_PATTERNS above.
# BLOCKED_PATTERNS_FILE=/app/blocked-patterns.txt

# Logging
LOG_LEVEL=INFO

# ── Optional: Vector Memory ────────────────────────────────────────────

# Semantic search over curated Q&A knowledge
# To enable: uncomment COMPOSE_PROFILES and set QDRANT_API_KEY
# API key is auto-generated by install.sh. Do not share.
#COMPOSE_PROFILES=vectordb
QDRANT_API_KEY=

# ── Optional: Monitor Stack ────────────────────────────────────────────

# TimescaleDB metrics + Grafana dashboards
# To enable: add "monitor" to COMPOSE_PROFILES (comma-separated with vectordb if both)
# Passwords are auto-generated by install.sh. Do not share.
#TIMESCALE_PASSWORD=
#TIMESCALE_URL=postgresql://hcli:${TIMESCALE_PASSWORD}@h-cli-timescaledb:5432/hcli_metrics
#GRAFANA_ADMIN_PASSWORD=
#GRAFANA_INTERNAL_URL=http://h-cli-grafana:3000

# ── Optional: CVE Scanner ──────────────────────────────────────────────

# NVD API key — speeds up queries (50 req/30s vs 5 req/30s)
# Get one free at https://nvd.nist.gov/developers/request-an-api-key
#NVD_API_KEY=

# Model for CVE analysis (default: sonnet)
#CVE_CHECK_MODEL=sonnet

# Inference server for CVE scanner (if using non-Anthropic model)
#CVE_CHECK_BASE_URL=
#CVE_CHECK_API_KEY=

# ── Service APIs ────────────────────────────────────────────────────────

# Passed into core container for tool access
NETBOX_URL=
NETBOX_API_TOKEN=

GRAFANA_URL=
GRAFANA_API_TOKEN=

EVE_NG_URL=
EVE_NG_USERNAME=
EVE_NG_PASSWORD=

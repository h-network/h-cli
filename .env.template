# h-cli Configuration
# Copy to .env and fill in your values: cp .env.template .env

# Redis
REDIS_PASSWORD=changeme-generate-a-real-password

# Core container base image (default: debian:12-slim, alternative: parrotsec/core:7.1)
CORE_BASE_IMAGE=debian:12-slim

# SSH Keys Directory (override to use keys from a different path)
SSH_KEYS_DIR=./ssh-keys

# Claude Code authentication (one-time setup)
# After first build, run: docker compose run claude-code claude login
# Follow the URL to authenticate with your Max/Pro subscription.
# Credentials persist in the claude-credentials volume — no API costs.

# Telegram Client
TELEGRAM_BOT_TOKEN=your-bot-token-here

# Session TTL (seconds) — conversation context window (default: 4 hours)
SESSION_TTL=14400

# History TTL (seconds) — how long conversation history stays in Redis (default: 24 hours)
# Separate from SESSION_TTL — history survives longer so it can be dumped to disk
HISTORY_TTL=86400

# Logging
LOG_LEVEL=INFO

# Security
MAX_CONCURRENT_TASKS=3
TASK_TIMEOUT=300
ALLOWED_CHATS=

# Result HMAC — signs task results so telegram-bot can verify authenticity
# Auto-generated by install.sh. Do not share.
RESULT_HMAC_KEY=

# Asimov Firewall — independent Haiku model checks every command against ground rules
# Adds ~2-3s latency per command. Set to true for production environments.
GATE_CHECK=true

# Sudo whitelist — comma-separated commands hcli can run as root (full paths resolved at startup)
SUDO_COMMANDS=nmap,tcpdump,traceroute,mtr,ping,ss,ip,iptables

# Command pattern blacklist — pipe-separated patterns blocked before gate check (deterministic, zero latency)
# Catches obfuscation tricks that an LLM gate might miss. Applied regardless of GATE_CHECK setting.
BLOCKED_PATTERNS=| bash|| sh|| zsh|base64 -d|base64 --decode

# External pattern file — one pattern per line, lines starting with # are ignored
# Default ships with ~80 patterns across 12 categories (blocked-patterns.txt)
# Override to use your own CVE signatures, large denylist feeds, or externally managed patterns
# Merged with BLOCKED_PATTERNS above.
# BLOCKED_PATTERNS_FILE=/app/blocked-patterns.txt

# Service APIs (passed into core container for tool access)
NETBOX_URL=
NETBOX_API_TOKEN=

GRAFANA_URL=
GRAFANA_API_TOKEN=

EVE_NG_URL=
EVE_NG_USERNAME=
EVE_NG_PASSWORD=
